<!-- Minimal surrounding tags. We want maximum cut-and-paste potential and browsers do well even without them. -->

<div style="width: 95%; height: 600px; width: 1000px;">
<svg viewBox="0 0 1000 600" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="100%" height="100%">
  
  <rect x="150.0" y="30.0" width="799.9999999999999" height="450.0" stroke="#000" fill="#EEE"/>
  <line x1="142.0" y1="480.0" x2="150.0" y2="480.0" stroke="#000"/>
  <text x="126.0" y="480.0" text-anchor="end" font-weight="bold" font-size="small" fill="#111">
  0.0
  </text>
  <line x1="142.0" y1="399.8938136473599" x2="150.0" y2="399.8938136473599" stroke="#000"/>
  <text x="126.0" y="399.8938136473599" text-anchor="end" font-weight="bold" font-size="small" fill="#111">
  0.2
  </text>
  <line x1="142.0" y1="319.78762729471975" x2="150.0" y2="319.78762729471975" stroke="#000"/>
  <text x="126.0" y="319.78762729471975" text-anchor="end" font-weight="bold" font-size="small" fill="#111">
  0.4
  </text>
  <line x1="142.0" y1="239.68144094207963" x2="150.0" y2="239.68144094207963" stroke="#000"/>
  <text x="126.0" y="239.68144094207963" text-anchor="end" font-weight="bold" font-size="small" fill="#111">
  0.6
  </text>
  <line x1="142.0" y1="159.5752545894395" x2="150.0" y2="159.5752545894395" stroke="#000"/>
  <text x="126.0" y="159.5752545894395" text-anchor="end" font-weight="bold" font-size="small" fill="#111">
  0.8
  </text>
  <line x1="142.0" y1="79.46906823679944" x2="150.0" y2="79.46906823679944" stroke="#000"/>
  <text x="126.0" y="79.46906823679944" text-anchor="end" font-weight="bold" font-size="small" fill="#111">
  1.0
  </text>
  <rect x="270.0" y="36.00000000000001" width="80.0" height="18.0" fill="#7070f8" stroke="#888"/>
  <text x="310.0" y="52.50000000000001" font-size="small" text-anchor="middle" font-weight="bold" fill="#111">
  No JIT
  </text>
  <rect x="510.0" y="36.00000000000001" width="80.0" height="18.0" fill="orange" stroke="#888"/>
  <text x="550.0" y="52.50000000000001" font-size="small" text-anchor="middle" font-weight="bold" fill="#111">
  YJIT
  </text>
  <rect x="750.0" y="36.00000000000001" width="80.0" height="18.0" fill="green" stroke="#888"/>
  <text x="790.0" y="52.50000000000001" font-size="small" text-anchor="middle" font-weight="bold" fill="#111">
  MJIT
  </text>
  <rect x="190.0" y="79.46906823679944" width="36.0" height="400.53093176320056" fill="#7070f8"/>
  <line x1="190.0" y1="79.2819079933657" x2="226.0" y2="79.2819079933657" stroke="#000"/>
  <line x1="190.0" y1="79.65622848023318" x2="226.0" y2="79.65622848023318" stroke="#000"/>
  <line x1="208.0" y1="79.2819079933657" x2="208.0" y2="79.65622848023318" stroke="#000"/>
  <rect x="226.0" y="352.7536573949858" width="36.0" height="127.24634260501423" fill="orange"/>
  <line x1="226.0" y1="352.66709686441055" x2="262.0" y2="352.66709686441055" stroke="#000"/>
  <line x1="226.0" y1="352.84021792556103" x2="262.0" y2="352.84021792556103" stroke="#000"/>
  <line x1="244.0" y1="352.66709686441055" x2="244.0" y2="352.84021792556103" stroke="#000"/>
  <rect x="262.0" y="353.5355027800182" width="36.0" height="126.46449721998184" fill="green"/>
  <line x1="262.0" y1="353.46694508242626" x2="298.0" y2="353.46694508242626" stroke="#000"/>
  <line x1="262.0" y1="353.6040604776102" x2="298.0" y2="353.6040604776102" stroke="#000"/>
  <line x1="280.0" y1="353.46694508242626" x2="280.0" y2="353.6040604776102" stroke="#000"/>
  <line x1="262.0" y1="480.0" x2="262.0" y2="484.8" stroke="#000"/>
  <text x="262.0" y="494.40000000000003" fill="#111" font-size="small" font-family="monospace" font-weight="bold" text-anchor="end" transform="rotate(-60, 262.0, 494.40000000000003)">
  fib
  </text>
  <rect x="333.99999999999994" y="79.46906823679944" width="36.0" height="400.53093176320056" fill="#7070f8"/>
  <line x1="333.99999999999994" y1="78.61864368626611" x2="369.99999999999994" y2="78.61864368626611" stroke="#000"/>
  <line x1="333.99999999999994" y1="80.31949278733278" x2="369.99999999999994" y2="80.31949278733278" stroke="#000"/>
  <line x1="352.0" y1="78.61864368626611" x2="352.0" y2="80.31949278733278" stroke="#000"/>
  <rect x="369.99999999999994" y="324.1940477439149" width="36.0" height="155.80595225608508" fill="orange"/>
  <line x1="369.99999999999994" y1="323.8577556607737" x2="405.99999999999994" y2="323.8577556607737" stroke="#000"/>
  <line x1="369.99999999999994" y1="324.53033982705614" x2="405.99999999999994" y2="324.53033982705614" stroke="#000"/>
  <line x1="387.99999999999994" y1="323.8577556607737" x2="387.99999999999994" y2="324.53033982705614" stroke="#000"/>
  <rect x="406.0" y="90.47408176936281" width="36.0" height="389.52591823063716" fill="green"/>
  <line x1="406.0" y1="89.48557955936549" x2="441.99999999999994" y2="89.48557955936549" stroke="#000"/>
  <line x1="406.0" y1="91.46258397936015" x2="441.99999999999994" y2="91.46258397936015" stroke="#000"/>
  <line x1="424.0" y1="89.48557955936549" x2="424.0" y2="91.46258397936015" stroke="#000"/>
  <line x1="406.0" y1="480.0" x2="406.0" y2="484.8" stroke="#000"/>
  <text x="406.0" y="494.40000000000003" fill="#111" font-size="small" font-family="monospace" font-weight="bold" text-anchor="end" transform="rotate(-60, 406.0, 494.40000000000003)">
  getivar
  </text>
  <rect x="478.0" y="79.46906823679944" width="36.0" height="400.53093176320056" fill="#7070f8"/>
  <line x1="478.0" y1="78.42067908963088" x2="514.0" y2="78.42067908963088" stroke="#000"/>
  <line x1="478.0" y1="80.51745738396801" x2="514.0" y2="80.51745738396801" stroke="#000"/>
  <line x1="496.0" y1="78.42067908963088" x2="496.0" y2="80.51745738396801" stroke="#000"/>
  <rect x="514.0" y="210.50557443133695" width="36.0" height="269.4944255686631" fill="orange"/>
  <line x1="514.0" y1="209.7452897445359" x2="550.0" y2="209.7452897445359" stroke="#000"/>
  <line x1="514.0" y1="211.26585911813802" x2="550.0" y2="211.26585911813802" stroke="#000"/>
  <line x1="532.0" y1="209.7452897445359" x2="532.0" y2="211.26585911813802" stroke="#000"/>
  <rect x="549.9999999999999" y="142.29472626778164" width="36.0" height="337.70527373221836" fill="green"/>
  <line x1="549.9999999999999" y1="140.99780773751965" x2="586.0" y2="140.99780773751965" stroke="#000"/>
  <line x1="549.9999999999999" y1="143.59164479804363" x2="586.0" y2="143.59164479804363" stroke="#000"/>
  <line x1="568.0" y1="140.99780773751965" x2="568.0" y2="143.59164479804363" stroke="#000"/>
  <line x1="549.9999999999999" y1="480.0" x2="549.9999999999999" y2="484.8" stroke="#000"/>
  <text x="549.9999999999999" y="494.40000000000003" fill="#111" font-size="small" font-family="monospace" font-weight="bold" text-anchor="end" transform="rotate(-60, 549.9999999999999, 494.40000000000003)">
  respond_to
  </text>
  <rect x="621.9999999999999" y="79.46906823679944" width="36.0" height="400.53093176320056" fill="#7070f8"/>
  <line x1="621.9999999999999" y1="75.37500054016533" x2="657.9999999999999" y2="75.37500054016533" stroke="#000"/>
  <line x1="621.9999999999999" y1="83.56313593343356" x2="657.9999999999999" y2="83.56313593343356" stroke="#000"/>
  <line x1="639.9999999999999" y1="75.37500054016533" x2="639.9999999999999" y2="83.56313593343356" stroke="#000"/>
  <rect x="657.9999999999999" y="127.81018168252112" width="36.0" height="352.1898183174789" fill="orange"/>
  <line x1="657.9999999999999" y1="121.86894189203848" x2="694.0" y2="121.86894189203848" stroke="#000"/>
  <line x1="657.9999999999999" y1="133.75142147300377" x2="694.0" y2="133.75142147300377" stroke="#000"/>
  <line x1="675.9999999999999" y1="121.86894189203848" x2="675.9999999999999" y2="133.75142147300377" stroke="#000"/>
  <rect x="693.9999999999999" y="173.9820815223288" width="36.0" height="306.01791847767123" fill="green"/>
  <line x1="693.9999999999999" y1="169.03519544011704" x2="729.9999999999999" y2="169.03519544011704" stroke="#000"/>
  <line x1="693.9999999999999" y1="178.92896760454056" x2="729.9999999999999" y2="178.92896760454056" stroke="#000"/>
  <line x1="711.9999999999999" y1="169.03519544011704" x2="711.9999999999999" y2="178.92896760454056" stroke="#000"/>
  <line x1="693.9999999999999" y1="480.0" x2="693.9999999999999" y2="484.8" stroke="#000"/>
  <text x="693.9999999999999" y="494.40000000000003" fill="#111" font-size="small" font-family="monospace" font-weight="bold" text-anchor="end" transform="rotate(-60, 693.9999999999999, 494.40000000000003)">
  lee
  </text>
  <rect x="766.0" y="79.46906823679944" width="36.0" height="400.53093176320056" fill="#7070f8"/>
  <line x1="766.0" y1="73.41732942242594" x2="802.0" y2="73.41732942242594" stroke="#000"/>
  <line x1="766.0" y1="85.52080705117297" x2="802.0" y2="85.52080705117297" stroke="#000"/>
  <line x1="784.0" y1="73.41732942242594" x2="784.0" y2="85.52080705117297" stroke="#000"/>
  <rect x="802.0" y="154.55704617553766" width="36.0" height="325.44295382446234" fill="orange"/>
  <line x1="802.0" y1="147.92734649800784" x2="838.0000000000001" y2="147.92734649800784" stroke="#000"/>
  <line x1="802.0" y1="161.18674585306752" x2="838.0000000000001" y2="161.18674585306752" stroke="#000"/>
  <line x1="820.0000000000001" y1="147.92734649800784" x2="820.0000000000001" y2="161.18674585306752" stroke="#000"/>
  <rect x="838.0" y="61.50000000000001" width="36.0" height="418.5" fill="green"/>
  <line x1="838.0" y1="54.75937076743352" x2="874.0" y2="54.75937076743352" stroke="#000"/>
  <line x1="838.0" y1="68.24062923256649" x2="874.0" y2="68.24062923256649" stroke="#000"/>
  <line x1="856.0" y1="54.75937076743352" x2="856.0" y2="68.24062923256649" stroke="#000"/>
  <line x1="838.0" y1="480.0" x2="838.0" y2="484.8" stroke="#000"/>
  <text x="838.0" y="494.40000000000003" fill="#111" font-size="small" font-family="monospace" font-weight="bold" text-anchor="end" transform="rotate(-60, 838.0, 494.40000000000003)">
  activerecord
  </text>
  </svg>
</div>

<p>
	The y axis is CRuby's runtime for the benchmark divided by the named interpreter (YJIT, MJIT, TruffleRuby). Shorter bars mean better performance. Each benchmark is scaled to the CRuby's interpreter's mean result.
</p>

<table>
	<thead>  <th>bench</th>  <th>No JIT (ms)</th>  <th>No JIT RSD</th>  <th>YJIT (ms)</th>  <th>YJIT RSD</th>  <th>MJIT (ms)</th>  <th>MJIT RSD</th>  <th>YJIT spd</th>  <th>YJIT spd RSD</th>  <th>MJIT spd</th>  <th>MJIT spd RSD</th>  <th>% in YJIT</th>  </thead>
	<tbody style="text-align: right;">
		
			<tr style="border: 1px solid black;">
				 <td> fib </td>  <td> 198.5 </td>  <td> 0.05% </td>  <td> 63.0 </td>  <td> 0.05% </td>  <td> 62.7 </td>  <td> 0.03% </td>  <td> 0.32x </td>  <td> 0.07% </td>  <td> 0.32x </td>  <td> 0.05% </td>  <td> 100.00% </td> 
			</tr>
		
			<tr style="border: 1px solid black;">
				 <td> getivar </td>  <td> 93.3 </td>  <td> 0.21% </td>  <td> 36.3 </td>  <td> 0.04% </td>  <td> 90.7 </td>  <td> 0.14% </td>  <td> 0.39x </td>  <td> 0.22% </td>  <td> 0.97x </td>  <td> 0.25% </td>  <td> 86.57% </td> 
			</tr>
		
			<tr style="border: 1px solid black;">
				 <td> respond_to </td>  <td> 237.0 </td>  <td> 0.26% </td>  <td> 159.4 </td>  <td> 0.11% </td>  <td> 199.8 </td>  <td> 0.28% </td>  <td> 0.67x </td>  <td> 0.28% </td>  <td> 0.84x </td>  <td> 0.38% </td>  <td> 100.00% </td> 
			</tr>
		
			<tr style="border: 1px solid black;">
				 <td> lee </td>  <td> 1140.6 </td>  <td> 1.02% </td>  <td> 1002.9 </td>  <td> 1.34% </td>  <td> 871.5 </td>  <td> 1.25% </td>  <td> 0.88x </td>  <td> 1.69% </td>  <td> 0.76x </td>  <td> 1.62% </td>  <td> 51.50% </td> 
			</tr>
		
			<tr style="border: 1px solid black;">
				 <td> activerecord </td>  <td> 151.8 </td>  <td> 1.51% </td>  <td> 123.3 </td>  <td> 1.37% </td>  <td> 158.6 </td>  <td> 0.56% </td>  <td> 0.81x </td>  <td> 2.04% </td>  <td> 1.04x </td>  <td> 1.61% </td>  <td> 74.97% </td> 
			</tr>
		
	</tbody>
</table>

<p>
	<b>RSD</b> is relative standard deviation - the standard deviation divided by the mean, expressed as a percentage. <br/>
	<b>% in YJIT</b> is the percentage of instructions that complete in YJIT rather than exiting to the non-JITted interpreter. YJIT performs better when this is higher.
</p>

<p>
	You can find our benchmark code <a href="https://github.com/Shopify/yjit-bench">in the yjit-bench Github repo</a>.
	Our benchmark-runner code isn't public yet, but we plan to release it later.
</p>

<p>
	Tested Ruby version for YJIT and No-JIT: <tt><b>ruby 3.1.0dev (2021-08-30T15:43:13Z main 093740af0a) [x86_64-linux]</b></tt> <br/>
	Tested Ruby version for MJIT: <tt><b>ruby 3.0.2p107 (2021-07-07 revision 0db68f0233) +JIT [x86_64-linux]</b></tt>
</p>


<p> Raw JSON data files: (if published) </p>

<ul>
  
    <li><a href="https://shopify.github.io/yjit-metrics/reports/2021-08-31-160016_basic_benchmark_prod_ruby_no_jit.json">2021-08-31-160016_basic_benchmark_prod_ruby_no_jit.json</a></li>
  
    <li><a href="https://shopify.github.io/yjit-metrics/reports/2021-08-31-160016_basic_benchmark_prod_ruby_with_yjit.json">2021-08-31-160016_basic_benchmark_prod_ruby_with_yjit.json</a></li>
  
    <li><a href="https://shopify.github.io/yjit-metrics/reports/2021-08-31-160016_basic_benchmark_ruby_30_with_mjit.json">2021-08-31-160016_basic_benchmark_ruby_30_with_mjit.json</a></li>
  
    <li><a href="https://shopify.github.io/yjit-metrics/reports/2021-08-31-160016_basic_benchmark_yjit_stats.json">2021-08-31-160016_basic_benchmark_yjit_stats.json</a></li>
  
</ul>

